# О курсе
Курс посвящён машинному обучению, направлению искусственного интеллекта, где задачи решаются на основе анализа данных. Нередко большого количества данных. В курсе будут рассмотрены основные понятия машинного обучения, способы анализа и визуализации данных, преобразования данных в вид, подходящий для моделей машинного обучения. Будут рассмотрены классические модели машинного обучения, начиная от регрессий, заканчивая градиентным бустингом; методы обучения и оптимизации качества этих моделей. В конце курса будут рассмотренные полносвязные нейросети (многослойные персепторн). 

Задания будут посвящены преимущественно обработке табличных и текстовых данных на примере синтетических и реальных наборов данных.

Рассматриваемые не нейросетевые методы МО применяются на практике, не смотря на большую популярность нейросетей. Курс можно считать как самостоятельным, так и длинным, но во многом обязательным, введением в курс нейросетевого анализа данных. Последний будет проходить в следующем семестре.

**См. также** план предыдущего курса, ссылки и примеры на главной странице, записи лекций предыдущего курса в дискорде.

## Требования для успешного усвоения курса.

Для успешного освоения курса необходимы знания языка программирования Python, основ линейной алгебры, математического анализа и методов оптимизации.

### Материалы для ознакомления перед началом курса
0. Шпаргалка по Python https://miro.com/app/board/uXjVNQC1rq8=/?share_link_id=860218532001
0. Теория вероятностей и математическая статистика
    - [raw.githubusercontent.com/VetrovSV/AppMathST/master/variables_1.pdf](https://raw.githubusercontent.com/VetrovSV/AppMathST/master/variables_1.pdf)
   - [raw.githubusercontent.com/VetrovSV/AppMathST/master/variables_2.pdf](https://raw.githubusercontent.com/VetrovSV/AppMathST/master/variables_2.pdf)
   - [raw.githubusercontent.com/VetrovSV/AppMathST/master/statistics.pdf](https://raw.githubusercontent.com/VetrovSV/AppMathST/master/statistics.pdf)
   - Примеры распределений и их вид в зависимости от параметров: [seeing-theory.brown.edu/probability-distributions/index.html#section3](https://seeing-theory.brown.edu/probability-distributions/index.html#section3)
   - Среднее значение (average) и дисперсия (variance), интерактивный пример: [seeing-theory.brown.edu/basic-probability/index.html#section3](https://seeing-theory.brown.edu/basic-probability/index.html#section3)

0. Математическая статистика, основы numpy, pandas, matplotlib
    1. [Математические модели и вычислительные методы обработки экспериментальных данных](https://raw.githubusercontent.com/ivtipm/ML/main/%D0%9C%D0%B0%D1%82%D0%B5%D0%BC%D0%B0%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B5%20%D0%BC%D0%BE%D0%B4%D0%B5%D0%BB%D0%B8%20%D0%B8%20%D0%B2%D1%8B%D1%87%D0%B8%D1%81%D0%BB%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D1%8B%D0%B5%20%D0%BC%D0%B5%D1%82%D0%BE%D0%B4%D1%8B%20%D0%BE%D0%B1%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B8%20%D1%8D%D0%BA%D1%81%D0%BF%D0%B5%D1%80%D0%B8%D0%BC%D0%B5%D0%BD%D1%82%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D1%85%20%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85.pdf)
    1. 6 способов значительно ускорить pandas с помощью пары строк кода: https://habr.com/ru/articles/503726/, https://habr.com/ru/articles/504006/


# План
# 1. Введение в машинное обучение. Математическая статистика. NumPy. Pandas.
1. Введение: [docs.google.com/presentation/d/1mK9CfhwjQtAdJZENV3vU4nCGSkzI8_Ugkv_AavBVEaM/edit?usp=sharing](https://docs.google.com/presentation/d/1mK9CfhwjQtAdJZENV3vU4nCGSkzI8_Ugkv_AavBVEaM/edit?usp=sharing)
1. Теория вероятностей и математическая статистика:
    - [raw.githubusercontent.com/VetrovSV/AppMathST/master/variables_2.pdf](https://raw.githubusercontent.com/VetrovSV/AppMathST/master/variables_2.pdf)
    - [raw.githubusercontent.com/VetrovSV/AppMathST/master/statistics.pdf](https://raw.githubusercontent.com/VetrovSV/AppMathST/master/statistics.pdf)

### Задание 1. NumPy и основные понятия математической статистики
Не используйте никакие методы numpy array кроме sum и abs. Не используйте циклы, генераторы, функции стандартной библиотеки Питона sum, zip и map, используйте векторные вычисления numpy.

Используйте Google Colaboratory.

1. Для функций ошибок и величин, широко используемых в анализе данных и машинном обучении, напишите функции:
    1. для вычисления стандартного отклонения случайной величины;
    1. для вычисления ошибок MSE, MAE, accuracy, precision, recall, f1 score. 
    Функции должны принимать два параметра y_pred, y_true. См. аналогичные функции из библиотеки sklearn;
    1. для вычисления функции softmax на нескольких переменных, используйте `numpy.exp`;
    1. вычисления линейного коэффициента корреляции;
    1. для вычисления предсказания для нескольких объектов по заданному коэффициентами уравнения линейной регрессии;
    1. подбора коэффициентов линейной регрессии, с использованием метода наименьших квадратов и функцией `minimize` модуля `scipy.optimize`.
1. Напишите тесты для этих функций;
1. Пишите поясняющие и документирующие комментарии;
1. Напишите формулы в формате LaTeX для всех функций, пояснения к формулам.

Для проверки кода, связанного с регрессией можно воспользоваться функцией `make_regression` из библиотеки Sklearn. Она создаёт синтетические данные для задачи регрессии. 

См. шпаргалку по Python: https://miro.com/app/board/uXjVNQC1rq8=, учебное пособие [Математические модели и вычислительные методы обработки экспериментальных данных](https://raw.githubusercontent.com/ivtipm/ML/main/%D0%9C%D0%B0%D1%82%D0%B5%D0%BC%D0%B0%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B5%20%D0%BC%D0%BE%D0%B4%D0%B5%D0%BB%D0%B8%20%D0%B8%20%D0%B2%D1%8B%D1%87%D0%B8%D1%81%D0%BB%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D1%8B%D0%B5%20%D0%BC%D0%B5%D1%82%D0%BE%D0%B4%D1%8B%20%D0%BE%D0%B1%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B8%20%D1%8D%D0%BA%D1%81%D0%BF%D0%B5%D1%80%D0%B8%D0%BC%D0%B5%D0%BD%D1%82%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D1%85%20%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85.pdf)

Задание может быть дополнено.



# Лекция 2. Основы Google Colaboratory. Синтетические данные. EVA. Линейная регрессия.

0. учебное пособие [Математические модели и вычислительные методы обработки экспериментальных данных](https://raw.githubusercontent.com/ivtipm/ML/main/%D0%9C%D0%B0%D1%82%D0%B5%D0%BC%D0%B0%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B5%20%D0%BC%D0%BE%D0%B4%D0%B5%D0%BB%D0%B8%20%D0%B8%20%D0%B2%D1%8B%D1%87%D0%B8%D1%81%D0%BB%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D1%8B%D0%B5%20%D0%BC%D0%B5%D1%82%D0%BE%D0%B4%D1%8B%20%D0%BE%D0%B1%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B8%20%D1%8D%D0%BA%D1%81%D0%BF%D0%B5%D1%80%D0%B8%D0%BC%D0%B5%D0%BD%D1%82%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D1%85%20%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85.pdf) - о построение графиков, numpy, pandas.

1. https://colab.research.google.com/drive/18YGaumubomt-Rtg_9_VT_nf1GwbMlEx8 - синтетические данные. EVA. Линейная регрессия.

2. [EDA, предобработка, кодирование colab.research.google.com/drive/1kLfmJ4q81BNZtMs-oVX9cKJGsT3mYWmR](https://colab.research.google.com/drive/1kLfmJ4q81BNZtMs-oVX9cKJGsT3mYWmR)

2. [Линейная регрессия. МНК. Метод макс.правдоподобия. sklearn.ipynb colab.research.google.com/drive/1YadlNYk9_WkCQY6L-HKP9SI7xZjuzIMx](https://colab.research.google.com/drive/1YadlNYk9_WkCQY6L-HKP9SI7xZjuzIMx?usp=sharing)


### Задание 1. Основы Google colab. Синтетические данные. Простое исследование данных (EVA). Линейная регрессия.
1. Освойтесь в google colaboratory
    - Как создавать ячейки? Какие виды ячеек бывают?
    - Какие способы запуска ячеек есть? Как ячейки с кодом влияют друг на друга?
    - Что такое markdown? Как создавать заголовки (и просматривать их в Google Colaboratory), делать текст жирным, курсивом, приводить фрагменты кода с подсветкой синтаксиса, приводить формулы в записи LaTeX?
    - Как делиться проектом (тетрадкой - notebook)?
    - Приведите ссылку на задание, текст задания.
1. Изучите пример 1 из лекции. 
1. Создайте синтетический набор данных для решения задачи линейной регрессии. Количество объектов должно быть меньше 10к, количество независимых признаков - 4 или больше, среди них 1 или 2 не должны влиять на  целевую переменную. 
1. Исследуйте данные. 
    - Изучите числовые характеристики всех признаков через 7-point summary. Используйте метод `describe()` класса pandas.DataFrame. Напишите пояснения для этих характеристик.
    - Постройте диаграммы размаха для всех признаков (seaborn.boxplot), скрипичные диаграммы (violinplot). Напишите пояснения. Есть ли выбросы?
    - Разберитесь как задать размер полотна (изображения) для графиков? Как построить несколько графиков, на одном полотне, но с разными осями? Постройте несколько диаграмм размаха 
    - Постройте гистограмму для целевого признака. Используйте рекомендованное библиотекой число столбцов, задайте много столбцов. Опишите, как такая гистограмма устроена. Видны ли на гистограмме с большим количеством столбцов аномалии в данных?
    - Вычислите матрицу корреляции, сделайте для неё тепловую карту. Напишите, какие независимые признаки влияют на целевой сильнее всего? Есть ли математическая зависимость между независимыми признаками? Как это влияет на качество уравнения линейной регрессии?
    - Постройте попарные дигаммы рассеяния (seabor.pairplot). Что показывает такая диаграмма? Для какого распределения целевого признака предсказания уравнения линейной регрессии будут точнее всего? Постройте для этого признака отдельную диаграмму рассеяния (seaborn.jointplot).
    - Дополнительно используйте пакет plotly для построения двухмерной и трёхмерной диаграммы рассеяния. На диаграмме должен быть целевой признак, и два наиболее значимых независимых признака.
    - Бонус: дополнительно постройте диаграммы на свой выбор. 
2. Разделите исходные данные на выборку для обучения (train) и отложенную выборку (test) для проверки результатов обучения. Оцените качество модели на этих выборках. Почему результаты могут отличаться?
    - Вычисляйте ошибку MSE, MAE.  Используйте встроенные в sklearn функции. Используйте функции, созданные в предыдущем задании.
    - Вычислите коэффициент детерминации R2. О чём он говорит?  
    - upd: приведите функцию потерь, пояснения к ней. Зачем нужна эта функция?    
3. Напишите пояснения и комментарии к коду. Поясняйте общий алгоритм, смысл действий, понятия (std, mean, ...) параметры вызываемых функций, записанные в коде формулы (приведите их в LaTeX). Комментарии к коду можно оставлять в ячейках с кодом, остальные пояснения можно давать в ячейках с текстом.


Задание дополнено!


# Лекция 3. Функция потерь
1 марта
0. Повторение. Классификация vs регрессия. Показатели качества модели регрессии. Функция потерь для линейной регрессии.
1. Подбор параметров уравнения линейной регрессии. Метод наименьших квадратов. Понятие функции потерь. Понятие градиентного спуска. Аналитическое решение для коэффицентов линейной регрессии
 [Линейная регрессия. МНК. Метод макс.правдоподобия. sklearn.ipynb colab.research.google.com/drive/1YadlNYk9_WkCQY6L-HKP9SI7xZjuzIMx](https://colab.research.google.com/drive/1YadlNYk9_WkCQY6L-HKP9SI7xZjuzIMx?usp=sharing)



# Лекция 4. Задача классификации. Логистическая регрессия. Показатели качества классификации.
8 марта
- Повторение
- Линейная разделимость классов. Сигмоида. Вероятностная модель; LogLoss.
- [colab.research.google.com/drive/1AdbtsRkX0jRVByuAKJxchYPcciTgFpqh?usp=sharing](https://colab.research.google.com/drive/1AdbtsRkX0jRVByuAKJxchYPcciTgFpqh?usp=sharing)
- Показатели качества классификации: [docs.google.com/presentation/d/1mK9CfhwjQtAdJZENV3vU4nCGSkzI8_Ugkv_AavBVEaM/edit?usp=sharing](https://docs.google.com/presentation/d/1mK9CfhwjQtAdJZENV3vU4nCGSkzI8_Ugkv_AavBVEaM/edit?usp=sharing)



### Домашнее задание 2. Классификация на синтетических данных.
0. Приведите ссылку на задание, текст задания.
1. Сгенерируйте данные. Создайте 5 или больше независимых признака, в том числе 1-2 лишних, 2 класса. [ [пример](https://colab.research.google.com/drive/1AdbtsRkX0jRVByuAKJxchYPcciTgFpqh#scrollTo=57PKhQ2Ylni1) ]. Создавайте не более 10 тысяч объектов.
1. Исследуйте данные. 
    - Изучите числовые характеристики всех признаков через 7-point summary. Используйте метод `describe()` класса pandas.DataFrame. Напишите пояснения для этих характеристик.
    - Постройте диаграммы размаха для всех признаков (seaborn.boxplot), скрипичные диаграммы (violinplot). Напишите пояснения. Есть ли выбросы?
    - Разберитесь как задать размер полотна (изображения) для графиков? Как построить несколько графиков, на одном полотне, но с разными осями? Постройте несколько диаграмм размаха 
    - Постройте гистограмму для целевого признака. Используйте рекомендованное библиотекой число столбцов, задайте много столбцов. Опишите, как такая гистограмма устроена. Видны ли на гистограмме с большим количеством столбцов аномалии в данных?
    - Вычислите матрицу корреляции, сделайте для неё тепловую карту. Напишите, какие независимые признаки влияют на целевой сильнее всего? Есть ли математическая зависимость между независимыми признаками? Как это влияет на качество уравнения логистической регрессии? Имеет ли смысл считать коэф. корреляции для категориального признака?
    - Постройте попарные дигаммы рассеяния (seabor.pairplot). Кодируйте класс цветом. Что показывает такая диаграмма? Постройте для этого признака отдельную диаграмму рассеяния (seaborn.jointplot).
    - Дополнительно используйте пакет plotly для построения двухмерной и трёхмерной диаграммы рассеяния. На диаграмме должен быть целевой признак, и два наиболее значимых независимых признака.
    - Бонус: дополнительно постройте диаграммы на свой выбор. 
1. Обучите модель логистической регрессии. Приведите общую формулу, пояснения для неё. Приведите функцию потерь, пояснения к ней. Зачем она нужна?
1. Оцените её на отложенной выборке. Вычислите accuracy (общую точность), точность (precision), recall (полноту), меру f1. Опишите эти показатели. 
3. Напишите пояснения и комментарии к коду. Поясняйте общий алгоритм, смысл действий, понятия (std, mean, ...) параметры вызываемых функций, записанные в коде формулы (приведите их в LaTeX). Комментарии к коду можно оставлять в ячейках с кодом, остальные пояснения можно давать в ячейках с текстом.