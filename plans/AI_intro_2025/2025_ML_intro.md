# Введение в разработку интеллектуальных систем

## После освоения курса Вы сможете
* Ориентироваться в основных понятиях машинного обучения (МО): виды МО, данные, модели, методы МО и т.д.

* Понимать жизненный цикл ML-проекта и выбирать подходящие этапы: сбор данных, анализ данных, подготовка данных, обучение модели, валидация модели, создание приложения на основе модели.

* Обучать и оценивать простые модели надёжно: линейная/логистическая регрессия; строить пайплайны и кросс-валидацию.

* Выбирать и интерпретировать ключевые метрики качества (MAE/MSE/R², Accuracy/Precision/Recall/F1) и диагностировать переобучение и недообучение.

* Сериализовать модель и подготовить минимальный интерфейс/API (Gradio/FastAPI) для демонстрации результата.

CСм. также курс по программированию для МО: https://github.com/VetrovSV/Programming/blob/master/plans/ML/readme.md

# План
1. Основы ИИ: определения ИИ, машинного обучения (МО) и их взаимосвязь; отличие от классического программирования; примеры применения. История ИИ. [слайды - 1](https://docs.google.com/presentation/d/11zFsnGJAaCzFGGVAjrd_OyNGD-fB6uLr3R-azaof0Qk)

2. Жизненный цикл ML-проекта: этапы от бизнес-задачи до развертывания; CRISP-DM.  [слайды - 1](https://docs.google.com/presentation/d/11zFsnGJAaCzFGGVAjrd_OyNGD-fB6uLr3R-azaof0Qk)

3. Данные для МО: понятия признак (feature) и целевая переменная (target), типы данных, концепция разведочного анализа данных (EDA). [слайды - 1](https://docs.google.com/presentation/d/11zFsnGJAaCzFGGVAjrd_OyNGD-fB6uLr3R-azaof0Qk), [слайды - 2](https://docs.google.com/presentation/d/1mK9CfhwjQtAdJZENV3vU4nCGSkzI8_Ugkv_AavBVEaM)

4. Обучения с учителем: задачи регрессии и классификации; разделение данных на обучающую (train) и тестовую (test) выборки. [слайды - 1](https://docs.google.com/presentation/d/11zFsnGJAaCzFGGVAjrd_OyNGD-fB6uLr3R-azaof0Qk)

5. Простые модели: линейная и логистическая регрессия. Функции потерь: MSE, LogLoss. Использование scikit-learn: fit, predict.
    - Линейная регрессия: модель и пример: https://colab.research.google.com/drive/1YadlNYk9_WkCQY6L-HKP9SI7xZjuzIMx
    - [Короткая шпаргалка по линейной регрессии](https://github.com/ivtipm/ML/blob/main/slides%20etc/linreg/ML_intro_linreg.png?raw=true)
    - Логистическая регрессия: модель и пример: https://colab.research.google.com/drive/1AdbtsRkX0jRVByuAKJxchYPcciTgFpqh?usp=sharing#scrollTo=UmtvOZb6DzgM

6. Качество модели: метрики для регрессии (MAE, MSE, R²), метрики для классификации (Accuracy, Precision, Recall, F1-score), матрица ошибок, визуальное объяснение недообучения (underfitting) и переобучения (overfitting). Воспроизводимость экспериментов. [слайды - 2](https://docs.google.com/presentation/d/1mK9CfhwjQtAdJZENV3vU4nCGSkzI8_Ugkv_AavBVEaM)

7. Другие парадигмы в ИИ (Обзор): обучение без учителя (Unsupervised Learning), кластеризация; обучение с подкреплением (Reinforcement Learning), агент, среда, вознаграждение; краткий обзор других направлений.

8. Развертывание и использование модели: сериализация модели, концепция API для модели, создание простого веб-приложения с помощью Gradio и FastAPI.
    - Коротко о RESTful API → OpenAPI → FastAPI: https://github.com/ivtipm/ML/tree/main/examples/FastAPI
    - Создание простого пользовательского интерфейса (Gradio): https://github.com/ivtipm/ML/blob/main/examples/gradio.ipynb
9. Простейшее приложение в докер-контейнере.\
   Примеры:
    - https://github.com/ivtipm/ML/blob/main/examples/docker-ML-web
    - https://github.com/ivtipm/ML/blob/main/examples/docker-api 


# Задания

## Линейная регрессия

Используйте библиотеку sklearn.

1. Освойтесь в google colaboratory или VS Code
    - Как создавать ячейки? Какие виды ячеек бывают?
    - Какие способы запуска ячеек есть? Как ячейки с кодом влияют друг на друга?
    - Что такое markdown? Как создавать заголовки (и просматривать их в Google Colaboratory), делать текст жирным, курсивом, приводить фрагменты кода с подсветкой синтаксиса, приводить формулы в записи LaTeX?
    - Как делиться проектом (тетрадкой - notebook)?
    - Приведите ссылку на задание, текст задания.

1. Создайте синтетический набор данных для решения задачи линейной регрессии. Количество объектов должно быть меньше 500, количество независимых признаков - 4 или больше, среди них 1 или 2 не должны влиять на  целевую переменную. Используйте функцию make_regression из sklearn. Задавайте random_state равным номеру зачётной книжки.

1. Исследуйте данные. 
    - Изучите числовые характеристики всех признаков через 7-point summary. Используйте метод `describe()` класса pandas.DataFrame. Напишите пояснения для этих характеристик.
    - Постройте диаграммы размаха для всех признаков (seaborn.boxplot), скрипичные диаграммы (violinplot). Напишите пояснения. Есть ли выбросы?
    - Разберитесь как задать размер полотна (изображения) для графиков? Как построить несколько графиков, на одном полотне, но с разными осями? Постройте несколько диаграмм размаха 
    - Постройте гистограмму для целевого признака. Используйте рекомендованное библиотекой число столбцов, задайте много столбцов. Опишите, как такая гистограмма устроена. Видны ли на гистограмме с большим количеством столбцов аномалии в данных?
    - Вычислите матрицу корреляции, сделайте для неё тепловую карту. Напишите, какие независимые признаки влияют на целевой сильнее всего? Есть ли математическая зависимость между независимыми признаками? Как это влияет на качество уравнения линейной регрессии?
    - **Постройте попарные дигаммы рассеяния (seaborn.pairplot). Что показывает такая диаграмма? Для какого распределения целевого признака предсказания уравнения линейной регрессии будут точнее всего? Постройте для этого признака отдельную диаграмму рассеяния (seaborn.jointplot).**
    - Дополнительно используйте пакет plotly для построения двухмерной и трёхмерной диаграммы рассеяния. На диаграмме должен быть целевой признак, и два наиболее значимых независимых признака.
    - Бонус: дополнительно постройте диаграммы на свой выбор. 
1. **Обучите модель линейной регрессии**
2. Разделите исходные данные на выборку для обучения (train) и отложенную выборку (test) для проверки результатов обучения. Оцените качество модели на этих выборках. Почему результаты могут отличаться?
    - **Вычисляйте ошибку MSE, MAE.  Используйте встроенные в sklearn функции.** 
    - Вычислите коэффициент детерминации R2. О чём он говорит?  
    - upd: приведите функцию потерь, пояснения к ней. Зачем нужна эта функция?    
3. **Напишите пояснения и комментарии к коду. Поясняйте общий алгоритм, смысл действий**, понятия (std, mean, ...) **параметры вызываемых функций**, записанные в коде формулы (приведите их в LaTeX). Комментарии к коду можно оставлять в ячейках с кодом, остальные пояснения можно давать в ячейках с текстом.

[Короткая шпаргалка по линейной регрессии](https://github.com/ivtipm/ML/blob/main/slides%20etc/linreg/ML_intro_linreg.png?raw=true)

5. Выполните оценку модели методом Cross Validation (CV). Разбивайте все данные на 5 частей. Вычислите средний R2.\
Запишите: отличается ли R2 на тестовой выборке, котоую вы сделали ранее, от полученной по CV. Объясните это. 

**Настройка VS Code для работы с jupyter notebook**

<details>

1. Скачайте и установить VS Code: https://code.visualstudio.com/
2. Установите дополнение Python от Microsoft.\
Оно поможет работать с виртуальными окружениями Питона.
2. Установите дополнение Jupyter от Microsoft\
Дальнейшие инструкции можно посмотреть во встроенной пошаговой инструкции: F1 > Welcome: Open Walkthrough... > Get started with jupyter notebook
3. Создайте файл с расширением .ipynb
4. Запустите ячейку с кодом: Shift + Enter. При необходимости установите рекомендуемые модули для работы с Jupyter Notebook и другие расширения для VS Code. Например Data Wrangler для удобного просмотра больших таблиц.

</details>

## Датасеты. Первичный анализ данных.
1. Загрузка и первичный анализ данных. Запросы к pandas.
1. Визуализации.

## Модели. Классификация и регрессия.
1. Подготовка данных. 
1. Обучение и оценка модели.
1. Пайплайны?

## Контейнер с моделью?
1. 
## Генетический алгоритм?

## Тест

# Экзамен
