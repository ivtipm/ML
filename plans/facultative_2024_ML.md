# ДПО. Модуль: машинное обучение

# Занятие 1. Введение в МО.
3 февраля
1. Понятие МО. Задачи МО: классификация и регрессия.
2. Представление данных. Виды признаков по природе значений (числовой, номинальный, категориальный). \
Виды признаков по задаче (независимые, зависимые (целевые))
3. Пример проекта в среде Jupyter Notebook в сервисе Google Colaboratory: обучение модели линейной регрессии с помощью библиотеки SKLearn [[подробнее про линейную регрессию](https://colab.research.google.com/drive/1YadlNYk9_WkCQY6L-HKP9SI7xZjuzIMx?usp=sharing#scrollTo=pxeShTXsN2xZ)]

- Слайды: https://docs.google.com/presentation/d/1mK9CfhwjQtAdJZENV3vU4nCGSkzI8_Ugkv_AavBVEaM/edit?usp=sharing
- Пример: https://colab.research.google.com/drive/18YGaumubomt-Rtg_9_VT_nf1GwbMlEx8?usp=sharing

См. запись занятия в чате группы


### Домашнее задание 0. Основы Google colab. Синтетические данные. Простое исследование данных. Линейная регрессия.
1. Освойтесь в google colaboratory
    - Как создавать ячейки? Какие виды ячеек бывают?
    - Какие способы запуска ячеек есть? Как ячейки с кодом влияют друг на друга?
    - Что такое markdown? Как создавать заголовки (и просматривать их в Google Colaboratory), делать текст жирным, курсивом, приводить фрагменты кода с подсветкой синтаксиса, приводить формулы в записи LaTeX?
    - Как делиться проектом (тетрадкой - notebook)?
    - upd: приведите ссылку на задание, текст задания.
1. upd: Исследуйте данные. 
    - Изучите числовые характеристики всех признаков через 7-point summary. Используйте метод `describe()` класса pandas.DataFrame. Напишите пояснения для этих характеристик.
    - Вычислите те же характеристики используя библиотеку numpy, используйте только методы sum, min, max, quantile.
    - Постройте диаграммы размаха для всех признаков (seaborn.boxplot)
    - Постройте гистограмму для целевого признака. Используйте рекомендованное библиотекой число столбцов, задайте много столбцов. Опишите, как такая гистограмма устроена. Видны ли на гистограмме с большим количеством столбцов аномалии в данных?
    - Вычислите матрицу корреляции, сделайте для неё тепловую карту. Напишите, какие независимые признаки влияют на целевой сильнее всего? Есть ли математическая зависимость между независимыми признаками? Как это влияет на качество уравнения линейной регрессии?
    - Постройте попарные дигаммы рассеяния (seabor.pairplot). Что показывает такая диаграмма? Для какого распределения целевого признака предсказания уравнения линейной регрессии будут точнее всего? Постройте для этого признака отдельную диаграмму рассеяния (seaborn.jointplot)
1. Изучите пример. Попробуйте обучить модель (линейную регрессию) для другого числа объектов и признаков. Проверьте полученное уравнение.
2. Разделите исходные данные на выборку для обучения (train) и отложенную выборку (test) для проверки результатов обучения. Оцените качество модели на этих выборках. Почему результаты могут отличаться?
    - Вычисляйте ошибку MSE, MAE. Используйте встроенные в sklearn функции. 
    - Вычислите стандартное отклонение ошибки.
    - Реализуйте эти вычисления самостоятельно, используя массив NumPy, но не используйте никакие методы кроме суммы.
    - upd: вычислите коэффициент детерминации R2. О чём он говорит? 
3. Напишите пояснения и комментарии к коду. Поясняйте общий алгоритм, смысл действий, понятия (std, mean, ) параметры вызываемых функций, записанные в коде формулы (приведите их в LaTeX). Комментарии к коду можно оставлять в ячейках с кодом, остальные пояснения можно давать в ячейках с текстом.



# Занятие 2. Введение в МО. Линейная регрессия.
1. Повторение. Опрос.
    - Что такое МО? Чем оно отличается от решения задач традиционным программированием?
    - Какие задачи может решать МО? На какие подвиды делиться задача прогнозирования (предсказания)? Чем они отличаются?
    - Как представляют данные в МО? Какие виды признаков бывают?
    - Какая модель МО была рассмотрена на прошлом занятии? Как её можно описать? Как её обучить?
    - Что такое Jupyter Notebook? Что такое Google Colaboratory? Как в тетрадке (notebook) сделать заголовки? Как поделиться? Как форматировать текст?
1. Показатели качества моделей [[Слайды](https://docs.google.com/presentation/d/1mK9CfhwjQtAdJZENV3vU4nCGSkzI8_Ugkv_AavBVEaM/edit?usp=sharing)] регрессии. Коэффициент детерминации.

1. Основы математической статистики:
   - [raw.githubusercontent.com/VetrovSV/AppMathST/master/variables_1.pdf](https://raw.githubusercontent.com/VetrovSV/AppMathST/master/variables_1.pdf)
   - [raw.githubusercontent.com/VetrovSV/AppMathST/master/variables_2.pdf](https://raw.githubusercontent.com/VetrovSV/AppMathST/master/variables_2.pdf)
   - [raw.githubusercontent.com/VetrovSV/AppMathST/master/statistics.pdf](https://raw.githubusercontent.com/VetrovSV/AppMathST/master/statistics.pdf)
   - Примеры распределений и их вид в зависимости от параметров: [seeing-theory.brown.edu/probability-distributions/index.html#section3](https://seeing-theory.brown.edu/probability-distributions/index.html#section3)
   - Среднее значение (average) и дисперсия (variance), интерактивный пример: [seeing-theory.brown.edu/basic-probability/index.html#section3](https://seeing-theory.brown.edu/basic-probability/index.html#section3)

1. NumPy. Pandas.
    - [Математические модели и вычислительные методы обработки экспериментальных данных](https://github.com/ivtipm/ML/blob/2c81049c9f1056d3be594642fde8c70d2d268d25/%D0%9C%D0%B0%D1%82%D0%B5%D0%BC%D0%B0%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B5%20%D0%BC%D0%BE%D0%B4%D0%B5%D0%BB%D0%B8%20%D0%B8%20%D0%B2%D1%8B%D1%87%D0%B8%D1%81%D0%BB%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D1%8B%D0%B5%20%D0%BC%D0%B5%D1%82%D0%BE%D0%B4%D1%8B%20%D0%BE%D0%B1%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B8%20%D1%8D%D0%BA%D1%81%D0%BF%D0%B5%D1%80%D0%B8%D0%BC%D0%B5%D0%BD%D1%82%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D1%85%20%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85.pdf)


- Пример: https://colab.research.google.com/drive/18YGaumubomt-Rtg_9_VT_nf1GwbMlEx8?usp=sharing


# Занятие 3. Введение в МО. Корреляция. Статистические визуализации
12 февраля

0. Повторение. Опрос. Объекты и признаки. Целевой признак, независимые признаки. Дисперсия, математическое ожидание, квартили. Тренировочная и тестовая выборка. Переобучение. Классификация и регрессия. Оценка качества регресии, MAE, MSE, R2.
1. Основы математической статистики:
   - [raw.githubusercontent.com/VetrovSV/AppMathST/master/statistics.pdf](https://raw.githubusercontent.com/VetrovSV/AppMathST/master/statistics.pdf)
   - Выборки
   - Корреляция и уравнение регреcсии
   - Коэффициент детерминации R2 [[слайды](https://docs.google.com/presentation/d/1mK9CfhwjQtAdJZENV3vU4nCGSkzI8_Ugkv_AavBVEaM/edit#slide=id.ga34d6fd6e8_0_572)]

# Занятие 4. Функция потерь для линейной и логичтической регрессии.
0. Повторение. Модель машинного обучения. Виды признаков по их природе. Линейная регрессия.
1. Подбор параметров уравнения регрессии.
    - Аналитический
    - Численный
    - Масштабирование признаков
        - Нормирование
        - Стандартизация
    - [Теория, Пример](https://colab.research.google.com/drive/1YadlNYk9_WkCQY6L-HKP9SI7xZjuzIMx)
1. Вероятностная модель. Логистическая регрессия
    [Теория,Пример](https://colab.research.google.com/drive/1AdbtsRkX0jRVByuAKJxchYPcciTgFpqh)
1. Показатели качества модели классификации (accuracy (общая точность), точность (precision), recall (полнота), мера f1): 
https://docs.google.com/presentation/d/1mK9CfhwjQtAdJZENV3vU4nCGSkzI8_Ugkv_AavBVEaM/edit#slide=id.ga34d6fd6e8_0_730




### Домашнее задание 2. Классификация на синтетических данных.
0. Приведите ссылку на задание, текст задания.
1. Сгенерируйте данные. Создайте 5 или больше независимых признака, в том числе 1-2 лишних, 2 класса. [ [пример](https://colab.research.google.com/drive/1AdbtsRkX0jRVByuAKJxchYPcciTgFpqh#scrollTo=57PKhQ2Ylni1) ]
1. Проведите разведочный анализ данных.
    - 7 point summary,
    - диаграммы размаха, скрипичные диаграммы (violin plot),
    - матрица корреляции,
    - попарные диаграммы рассеяния,
    - столбчатую диаграмму для целевого признака, что можно сказать про баланс классов?
    - Коротко опишите данные. Сколько признаков? Какие признаки сильнее всего влияют на целевой признак? Есть ли выбросы? Какие распределения имеют признаки (нормальное, равномерное и т.п.)?
    - upd: Бонус: интерактивные диаграммы на основе plotly: гистограммы для важны?
1. Обучите модель логистической регрессии. Приведите общую формулу, пояснения для неё.
1. Оцените её на отложенной выборке.
Вычислите accuracy (общую точность), точность (precision), recall (полноту), меру f1. Опишите эти показатели. 
1. upd: Если признаки имеют примерно одинаковую шкалу (минимумы и максимумы признаков отличаются на несколько процентов, или стандартные отклонения и средние значения признаков отличаются на несколько процентов), то опишите важность признаков, на основе коэффициентов регрессии.

Задание дополнено!


# Занятие 5. EVA. Кодирование. Pandas.
0. Повторение. Модель машинного обучения - функция потерь (ошибок) - метрики качества. Логистическая и линейная регрессия. Стандартное отклонение и математическое ожидание.
1. Выполнение консольных команд в Jupyter Notebook (в сервисе Google Colab)
1. Показатели качества модели классификации (accuracy (общая точность), точность (precision), recall (полнота), мера f1): 
https://docs.google.com/presentation/d/1mK9CfhwjQtAdJZENV3vU4nCGSkzI8_Ugkv_AavBVEaM/edit#slide=id.ga34d6fd6e8_0_730
2. Pandas. [Математические модели и вычислительные методы обработки экспериментальных данных](https://raw.githubusercontent.com/ivtipm/ML/main/%D0%9C%D0%B0%D1%82%D0%B5%D0%BC%D0%B0%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B5%20%D0%BC%D0%BE%D0%B4%D0%B5%D0%BB%D0%B8%20%D0%B8%20%D0%B2%D1%8B%D1%87%D0%B8%D1%81%D0%BB%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D1%8B%D0%B5%20%D0%BC%D0%B5%D1%82%D0%BE%D0%B4%D1%8B%20%D0%BE%D0%B1%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B8%20%D1%8D%D0%BA%D1%81%D0%BF%D0%B5%D1%80%D0%B8%D0%BC%D0%B5%D0%BD%D1%82%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D1%85%20%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85.pdf)]
    - Основные понятия: Колонки и данные. Создание. Загрузка из файла и загрузка по сети. Добавление колонок. Применение функции к колонкам. Выбор колонок. Заросы с фильтрами. Группировки.  
    - Пропуски
    - Дубликаты
    - Выбросы. Метод отсечения на основе стандартного отклонения.
    - Баланс классов.
3. Кодирование данных. One-hot (унитарный код); числовое кодирование (label-encoding). Масштабирование данных: нормализация и стандартизация.
4. Перекрёстная проверка (cross-validation). Рассмотрите эту тему самостоятельно. 

Пример: https://colab.research.google.com/drive/1kLfmJ4q81BNZtMs-oVX9cKJGsT3mYWmR?usp=sharing


### Домашнее задание 3. EVA и классификация на реальных данных
0. Приведите ссылку на задание, текст задания.
1. Используйте один из предложенных датасетов:
    - вариант 1. https://raw.githubusercontent.com/ivtipm/ML/main/datasets/churn.csv (есть на Kaggle)
    - вариант 2 (сложнее, но даёт примерно в 1.5 раза больше баллов). https://archive.ics.uci.edu/ml/datasets/adult, https://www.kaggle.com/wenruliu/adult-income-dataset?select=adult.csv
    - можно обработать оба
или предложите свой датасет, сопоставимый по количеству и качеству данных с рекомендованным. Используйте свой датасет после согласования с преподавателем.
1. Проведите разведочный анализ данных.
    - 7 point summary,
    - Пропуски, дубликаты
    - диаграммы размаха, скрипичные диаграммы (violin plot),
    - матрица корреляции,
    - попарные диаграммы рассеяния,
    - столбчатую диаграмму для целевого признака, что можно сказать про баланс классов?
    - Коротко опишите данные. Сколько признаков? Какие признаки сильнее всего влияют на целевой признак? Есть ли выбросы? Какие распределения имеют признаки (нормальное, равномерное и т.п.)?
    - Удалите лишние признаки, кодируйте нечисловые признаки, удалите выбросы, масштабируйте признаки. Поясняйте действия, описывайте зачем их производите.
    - upd: Бонус: интерактивные диаграммы на основе plotly: гистограммы для важны?
    - Опишите данные: какие данные даны? Сколько признаков и объектов? Есть ли пропуски, дубликаты, выбросы
    -  *В начале работы рекомендуется удалить все неудобные (много пропусков, нужно кодировать, есть ошибки и т.п.) признаки и построить простую модель. Записывайте как проводили обработку данных и результаты. Далее, можно более тщательно изучить и погдготовить данные, снова обучить модель и сравнить результаты с предыдущим разом.*
1. Обучите модель логистической регрессии. Приведите общую формулу, пояснения для неё.
1. Оцените её на отложенной выборке.
Вычислите accuracy (общую точность), точность (precision), recall (полноту), меру f1. Опишите эти показатели. 
1. Поэкспериментируйте с процедурой обработки данных. Удаляйте лишние столбцы, модифицируйте колонки, удаляйте выбросы и т.п. Обучайте модель после каждого эксперимента. Записывайте как каждый этап влияет на качество модели.
1. Если признаки имеют примерно одинаковую шкалу (минимумы и максимумы признаков отличаются на несколько процентов, или стандартные отклонения и средние значения признаков отличаются на несколько процентов), то опишите важность признаков, на основе коэффициентов регрессии.

Задание будет дополнено



# Занятие 6. Предварительная обработка данных. (продолжение).
1. Масштабирование данных: нормализация и стандартизация. 
Важность признаков на основе логистической и линейной регрессии.
2. Перекрёстная проверка (cross-validation). Рассмотрите эту тему самостоятельно. 
3. KNN?
4. Дерево выбора?